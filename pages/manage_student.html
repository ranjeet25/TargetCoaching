<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- CSS & Bootstrap links -->

    <link rel="stylesheet" href="/css/admin.css" />
    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />
   <!-- Bootstrap Font Icon CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css">
    <!-- Bootstrap JavaScript -->
    <script
      src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"
      integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"
      integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF"
      crossorigin="anonymous"
      
    ></script>
     <script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>

    <!-- CSS & Bootstrap links Ends -->
    <title>Manage Students</title>
  </head>
  <body>
    <section class="main_container container-fluid">

    <!--  **********###### MODALS ######********** -->
      <!--  ****** EDIT Modal ***** -->
      <div class="modal fade " id="editModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered ">
          <div class="modal-content" style="width: auto; height:auto;">
            <div class="modal-header">
              <h5 class="modal-title" id="editModal">Update Student Info</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body " >
              <div class=" add_branch_admin create_branch_box">
                  <form id=" form_container" action="http://localhost:8100/admin/student_update" method="post">
                    <div class="col-md-12">
                      <div class="form-group">
                        <label id="branch-label" for="student_id"></label>
                          Student Id</label
                        >
                        <input
                          type="text"
                          name="student_id"
                          id="student_id"
                          placeholder="Enter Student ID"
                          class="btn_outline form-control"
                          required
                        />
                      </div>
                    </div>
                    <div class="col-md-12">
                      <div class="form-group">
                        <label id="branch-label" for="branch_name"></label>
                          Update Course</label
                        >
                        <input
                          type="text"
                          name="student_Course"
                          id="student_Course"
                          placeholder="Enter new course"
                          class="btn_outline form-control"
                          required
                        />
                      </div>
                    </div>
                    <div class="col-md-12">
                      <div class="form-group">
                        <label id="branch-label" for="branch_name"></label>
                          Update pending fees</label
                        >
                        <input
                          type="text"
                          name="pending_fees"
                          id="pending_fees"
                          placeholder="update pending fees"
                          class="btn_outline form-control"
                          required
                        />
                      </div>
                    </div>
                   
                   
                   
                    <div class="col-md-12">
                      <button
                        type="submit"
                        class="btn btn-outline-primary"
                        id="admin_btn_submit"
                      >
                        Update student information
                      </button>
                    </div>
                  </form>
                </div>
            </div>
            <!-- <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
              <button type="button" class="btn btn-primary">Save changes</button>
            </div> -->
          </div>
        </div>
      </div>
      
      <!--  **********###### MODALS  ENDS ######********** -->
 


      <div class="row">
        <div class="sidebar col-2">
          <section class="logo row">
            <h4>TargetCoaching</h4>
          </section>
          <section class="profile_box row">
            <div class="profile_content">
             
              <h6>Admin Panel</h6>
               <h4 id="name">Admin Name</h4>
              <p>Role <span>Branch Admin</span></p>
            </div>
          </section>
          

          <section class="button_box ">

              <p style="color: #fff; font-weight: 600;"><span id="b_name">Branch Name</span></p>
             <p style="color: #fff; font-weight: 600;"><span id="b_location">Branch location</span></p>

              <!-- *********** 01 MANAGE STAFFS ***********-->
            <button
             style="background-color: rgb(135, 245, 127); color: rgb(34, 34, 34);"
              class="side_btn btn btn-outline-light "
             data-bs-toggle="collapse" data-bs-target="#manage_staff"
            >
              Manage Students
            </button>
         <!-- *********** SUB MANAGE STAFFS ***********-->
          <div id="manage_staff" class="collapse"> 
            <!-- SUB BUTTON 01 -->
            <button
               
                onclick="addStaff()"
               class="staff add_staff btn btn-outline-light "
                >
                Add Student
            </button>
            <!-- SUB BUTTON 02 -->
            <button
                onclick="removeStaff()"
               class="staff add_staff btn btn-outline-light "
                >
                Remove Student
            </button>
            <!-- SUB BUTTON 03 -->
            <button
                onclick="viewStaff()"
               class="staff add_staff btn btn-outline-light "
                >
                View Students
            </button>
          </div>

           <!-- *********** 02 MANAGE STUDENTS ***********-->
           
            <button onclick="manage_staff()" style="margin-top: 20px;"
              
              class="side_btn btn btn-outline-light"
               data-bs-toggle="collapse" data-bs-target="#manage_Students"
            >
             
              Manage Staff
            </button>
          



             <!-- *********** 03 MANAGE COURSES ***********-->

            <button onclick="manage_courses()" style="margin-top: 20px;"
              
              class="side_btn btn btn-outline-light"
               data-bs-toggle="collapse" data-bs-target="#manage_Courses"
            >
              Manage Courses
            </button>

          

             <!-- *********** 04 MANAGE BATCHES ***********-->
            <button onclick="manage_batches()" style="margin-top: 20px;"
              
              class="side_btn btn btn-outline-light"
               data-bs-toggle="collapse" data-bs-target="#manage_Batches"
            >
             Manage Batches
            </button>

            

             <!-- *********** LOGOUT ***********-->
             <a href="/" style="margin-top: 20px;" class="side_btn btn btn-outline-danger">Logout</a>
          </section>
        </div>



        <div class="main_dashboard col">


          <!-- *********** 111111111  MAIN  SWITCHING CONTENT  CONTAINERS *********** -->

          <section class="staff_section content_section row">
            <div style="background-color: rgb(135, 245, 127);" class="content_1 container">
              <!-- ********* Contents ********* -->

              <!-- ********* 0001111 ********* -->
              <h4 id="dashboard_heading-1">Add Students</h4>
              <div
                id="content_container-1"
                class="content_container rounded rounded-5"
              >

              <!-- Content SECTION -->
                <div  class="create_branch_box" style="transform: scale(0.8);overflow-y: scroll;height: 100vh;">
                  <form  id=" form_container" action="http://localhost:8100/admin/manage_student" method="POST" >
                    <div class="col-md-12" >
                      <div class="form-group">
                        <label id="branch-label" for="branch_name"
                          >New Student Name</label
                        >
                        <input
                          type="text"
                          name="student_name"
                          id="branch_name"
                          placeholder="Enter student Name"
                          class="btn_outline form-control"
                          required
                        />
                      </div>
                    </div>

                    <div class="col-md-12">
                      <div class="form-group" >
                        <label id="location-label" for="location"
                          >Student username</label
                        >
                        <input
                          type="text"
                          name="student_username"
                          id="location"
                          placeholder="set username"
                          class="form-control"
                          required
                        />
                      </div>
                    </div>

                     <div class="col-md-12">
                      <div class="form-group" >
                        <label id="location-label" for="location"
                          >Student password</label
                        >
                        <input
                          type="password"
                          name="student_password"
                          id="location"
                          placeholder="set password"
                          class="form-control"
                          required
                        />
                      </div>
                    </div>

                     <div class="col-md-12">
                      <div class="form-group" >
                        <label id="location-label" for="location"
                          >Course selected</label
                        >
                        <input
                          type="text"
                          name="course"
                          id="location"
                          placeholder="Enter Course enrolled "
                          class="form-control"
                          required
                        />
                      </div>
                    </div>

                     <div class="col-md-12">
                      <div class="form-group" >
                        <label id="location-label" for="location"
                          >Batch</label
                        >
                        <input
                          type="text"
                          name="batch"
                          id="location"
                          placeholder="Enter Batch allocated "
                          class="form-control"
                          required
                        />
                      </div>
                    </div>

                    <div class="col-md-12">
                      <div class="form-group">
                        <label id="date-label" for="date">Admission Date</label>
                        <input type="date" name="date" class="form-control" id="date" />
                      </div>
                    </div>


                    <div style="display: flex;">
                     <div class="col-md-6" style="margin-right: 8px;">
                      <div class="form-group" >
                        <label id="location-label" for="location"
                          >Fees paid by student</label
                        >
                        <input
                          type="text"
                          name="fees_paid"
                          id="location"
                          placeholder="Enter Fees paid "
                          class="form-control"
                          required
                        />
                      </div>
                    </div>

                      <div class="col-md-6">
                      <div class="form-group" >
                        <label id="location-label" for="location"
                          >Fees pending by student</label
                        >
                        <input
                          type="text"
                          name="fees_pending"
                          id="location"
                          placeholder="Enter Fees pending "
                          class="form-control"
                          required
                        />
                      </div>
                    </div>
                    </div>

                    <!-- Hidden Input to collect Branch ID -->

                     <div style="display: none;" class="col-md-12">
                      <div class="form-group">
                        <input
                          type="text"
                          name="branch_id"
                          id="branch_id"
                          value="AdminNotLoggedIn";
                          class="form-control"
                        />
                      </div>
                    </div>
                     <!-- Hidden Input to collect Branch ID -->

            
                    <div class="col-md-12">
                      <button
                        type="submit"
                        class="btn btn-outline-primary"
                        id="btn_submit"
                      >
                        Add Student
                      </button>
                    </div>
                  </form>
                </div>
                  <!-- Content SECTION -->
              </div>

              <!-- ********* 00022222 ********* -->
              <h4 style="display: none" id="dashboard_heading-3">
                Remove a Student
              </h4>
              <div
                id="content_container-3"
                class="content_container rounded rounded-5"
                style="display: none"
              >

                <!-- Content SECTION remove branches -->
                <div class=" remove_branch create_branch_box">
                  <form id=" form_container" action="http://localhost:8100/admin/removeStudent" method="post">
                    <div class="col-md-12">
                      <div class="form-group">
                        <label id="branch-label" for="branch_name"></label>
                          Student username</label
                        >
                        <input
                          type="text"
                          name="student_username"
                          id="remove_branch_name"
                          placeholder="Enter username to Remove"
                          class="btn_outline form-control"
                          required
                        />
                      </div>
                    </div>
                    <div class="col-md-12">
                      <div class="form-group">
                        <label style="font-size: medium;" id="branch_id-label" for="branch_id"
                          >Student ID</label
                        >
                        <input
                          type="text"
                          name="student_id"
                          id="branch_id"
                          placeholder="Enter student ID"
                          class="form-control"
                          required
                        />
                      </div>
                    </div>
                   
                    <div class="col-md-12">
                      <button
                        type="submit"
                        class="btn btn-outline-primary"
                        id="remove_btn_submit"
                      >
                        Remove Student
                      </button>
                    </div>
                  </form>
                </div>
                  <!-- Content SECTION -->
              </div>
              

              <!-- ********* 0003333 ********* -->
              <h4 style="display: none" id="dashboard_heading-2">
                View Students
              </h4>
              <div
                id="content_container-2"
                class="content_container rounded rounded-5"
                style="display: none"
              >
                <!-- Content SECTION -->
              <div style="overflow-y: scroll;" class="branch_detail_box">

                
                  <table class="table table-bordered table-hover ">
                         <thead >
                           <tr  >
                             <th scope="col">Srno</th>
                             <th scope="col">student ID</th>
                             <th scope="col"> Name</th>
                             <th scope="col">Username</th>
                             <th scope="col">course</th>
                             <th scope="col">fees</th>
                             <th scope="col">fees pending</th>
                             <th scope="col">Admission date</th>
                             <th scope="col">Edit</th>
                         
                            
                           </tr>
                         </thead>
                         <tbody id="data-output">
                           <tr >
                             <!-- <th scope="row">1</th>
                             <td id="branch_id"><span>12055fd8fgg45fd5</span></td>
                             <td>OM Target Tution</td>
                             <td>Boriwali</td>
                             <td>20-04-2023</td> -->
                           </tr>
                        
                         </tbody>
                        
                 </table>
              </div>
                <!-- Content SECTION -->
              
              </div>
            </div>
          
          </section>

           <!-- *********** 111111111  MAIN  SWITCHING CONTENT  CONTAINERS *********** -->



        </div>
      </div>
    </section>

    <script>

     fetch("http://localhost:8100/login/adminData")
   .then(res =>res.json())
   .then(data =>{
    document.getElementById("name").innerHTML = data.branch_Admin_name;
    document.getElementById("b_name").innerHTML = data.branch_name;
    document.getElementById("b_location").innerHTML = data.location;
    document.getElementById("branch_id").value = data._id;
   })

    
    var brachData = new Object()
    const url ="http://localhost:8100/login/studentDetails";
    fetch(url)
    .then(res => res.json())
    .then(data =>{
      data.reverse()
      brachData = data;
      getData();
    })

    var branch_id;

    function getData(){
      let placeholder = document.querySelector("#data-output");
      let out = "";
      for(let i=0 ; i<brachData.length ; i++){

      date = brachData[i].date.slice(0,10);
      
      var date = brachData[i].date.slice(0,10);
      var fees_pending = brachData[i].fees_pending;
      var fees_paid = brachData[i].fees_paid;
      const fees_pending_arr = fees_pending.split(",");
      const fees_paid_arr = fees_paid.split(",");

      var total_fees_pending = fees_pending_arr[0] + fees_pending_arr[1];
      var total_fees_paid = fees_paid_arr[0] + fees_paid_arr[1];

      var total_fees =parseInt(total_fees_pending)  + parseInt(total_fees_paid) ;
      //  console.log(total_fees)
      out += `
         <tr>
            <td>${i+1}</td>
            <td id="branch_id"><span>${brachData[i]._id}<span></td>
            <td>${brachData[i].student_name}</td>
            <td>${brachData[i].student_username}</td>
            <td>${brachData[i].course}</td>
            <td>${total_fees}</td>
            <td>${brachData[i].fees_pending}</td>
            <td>${date}</td>
            <td>  <button data-bs-toggle="modal" data-bs-target="#editModal" id="edit-btn"><i class="bi bi-pencil-square"></i></button></td>
           
            
         </tr>
      `;
    }

    placeholder.innerHTML = out;
  } 


      var dh1 = document.getElementById("dashboard_heading-1");
      var cc1 = document.getElementById("content_container-1");

      var dh2 = document.getElementById("dashboard_heading-2");
      var cc2 = document.getElementById("content_container-2");

      var dh3 = document.getElementById("dashboard_heading-3");
      var cc3 = document.getElementById("content_container-3");

      function addStaff() {
        if ((dh1.style.display = "none") && (cc1.style.display = "none")) {
          dh1.style.display = "inline";
          cc1.style.display = "flex";

          dh2.style.display = "none";
          cc2.style.display = "none";

          dh3.style.display = "none";
          cc3.style.display = "none";
        }
      }
      function viewStaff() {
        if ((dh2.style.display = "none") && (cc2.style.display = "none")) {
          dh2.style.display = "inline";
          cc2.style.display = "flex";

          dh1.style.display = "none";
          cc1.style.display = "none";

          dh3.style.display = "none";
          cc3.style.display = "none";
        }
      }
      function removeStaff() {
        if ((dh3.style.display = "none") && (cc3.style.display = "none")) {
          dh3.style.display = "inline";
          cc3.style.display = "flex";

          dh2.style.display = "none";
          cc2.style.display = "none";

          dh1.style.display = "none";
          cc1.style.display = "none";
        }
      }


       function manage_staff(){
        window.location.href = "/admin";
      }
       function manage_courses(){
         window.location.href = "/admin/manage_courses";
      }
       function manage_batches(){
        window.location.href = "/admin/manage_batches";
      }
    </script>
  </body>
</html>
